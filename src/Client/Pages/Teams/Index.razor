@page "/teams"
@inject ApiClient Api

<h1>Raid Teams</h1>

<button class="btn btn-primary mr-sm-2 mb-2" type="button" @onclick="() => _executor?.RestartAsync()">
    <span class="fas fa-sync" aria-hidden="true"></span>
    <span class="sr-only">Refresh</span>
</button>
<ApiExecutor Operation="Api.Teams.GetAllTeamNames" Context="teamNames" @ref="_executor">
    <AuthorizeView Roles="@AppRoles.Administrator">
        <Modal @ref="_createModal">
            @if (_createRequested)
            {
                <ModalBackdrop />
                <Create ParentModal="_createModal" />
            }
        </Modal>
        <button type="button" class="btn btn-primary mb-2" @onclick="CreateClicked">Create Team</button>
    </AuthorizeView>
    <div class="list-group">
        @foreach (var team in teamNames)
        {
            <a class="list-group-item" href="teams/@team">@team</a>
        }
    </div>
</ApiExecutor>

@code {
    private Modal? _createModal;
    private bool _createRequested;
    private IApiExecutor? _executor;

    private void CreateClicked()
    {
        _createRequested = true;
        _createModal?.Show();
    }
}
