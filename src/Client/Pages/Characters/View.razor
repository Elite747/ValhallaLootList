@page "/Characters/{character}"
@inject ApiClient Api
@inject PhaseConfigProvider PhaseConfig
@inject NavigationManager Nav

@if (_character is null)
{
    <LoadingIndicator />
}
else
{
    <h1>
        @_character.Name
        <RaceIcon Gender="_character.Gender" Race="_character.Race" Size="IconSize.Large" />
        <ClassIcon PlayerClass="_character.Class" Size="IconSize.Large" />
    </h1>

    @if (_character.TeamName?.Length > 0)
    {
        <h2><a href="teams/@_character.TeamName">&lt;@_character.TeamName&gt;</a></h2>
    }

    @if (_phases is not null)
    {
        <Tabs SelectedTab="@_selectedPhase" SelectedTabChanged="phase => _selectedPhase = phase">
            <Items>
                @foreach (byte phase in _phases)
                {
                    <Tab Name="@phase.ToString()">
                        Phase @phase.ToString()
                    </Tab>
                }
            </Items>
            <Content>
                @foreach (byte phase in _phases)
                {
                    <TabPanel Name="@phase.ToString()">
                        <LootListView Character="@_character" Phase="@phase" LootLists="_lootLists" />
                    </TabPanel>
                }
            </Content>
        </Tabs>
    }
}

@code {
    [Parameter] public string Character { get; set; } = string.Empty;

    private string? _selectedPhase;
}
